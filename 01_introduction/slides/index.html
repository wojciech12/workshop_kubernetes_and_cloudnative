<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>Kubernetes Introduction</title>

		<!-- bootstrap -->
		<link rel="stylesheet" href="ext/bootstrap-4.1.3/css/bootstrap.css">
		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/black.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">

		<!-- Printing and PDF exports -->
		<!-- script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script-->

		<!-- remove annoying shadow around images -->
		<style>
			.reveal section img {
				background-color:white;
				border:0;
				box-shadow: 0 0 0 0;
			}
		</style>
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h3>Kubernetes Introduction</h3>

					<img src="img/GopherKubernetes.png" class="center-block" style="background-color:white;border:0;width: 80%"/>
					<!-- h5>+ how to prepare your service</h5 -->
					<br />

					<h6><small>W<span style="text-transform: lowercase;">ojciech</span> B<span style="text-transform: lowercase;">arczyński</span> <br />
							<span style="text-transform: lowercase;">wbarczynski.pro@gmail.com</span></small>
				</section>

				<!-- section>
					<h3>Golang Warsaw Workshops</h3>
					<p>Idea / An experiment:</p>
						<ul>
							<li>member2member</li>
							<li>only at the meetup</li>
							<li>encorouge active feedback: going / notgoing</li>
							<li>Grow the community to 1000 persons</li>
							<li>50-60 per meeting</li>
						</ul>
						<small><p>Vision: be community driven</p></small>
				</section -->

				<!-- section>
					<h3>Golang Warsaw Workshops</h3>
					<p>Take the stage:</p>
						<ul>
							<li>One or more trainers</li>
							<li>min 1 talk at the Meetup in the last 8 months</li>
							<li>Topic important for you</li>
							<li>10-15</li>
							<li>2-8 hours</li>
							<li>OK to promote its commercial version</li>
						</ul>
						<p>Contact me: </p>
				</section -->

				<!-- section>
					<h3>Golang Warsaw Workshops</h3>
					<p>Topics:</p>
						<ul>
							<li>Introduction to Golang</li>
							<li>Golang Advanced:<br />Internals, Concurrency, Performance</li>
							<li>Getting started with K8S/CloudNative</li>
							<li>...</li>
						</ul>
				</section -->

				<!-- section>
					<h3>Golang Warsaw Workshops</h3>
					<p>Process:</p>
						<ul>
							<li>Send email to organizers</li>
							<li>if OK, we manage the rest</li>
							<li>find a venue</li>
							<li>announce on meetup.com</li>
							<li>and black-listing ;)</li>
						</ul>
						<small><p>Contact me:</p></small>
				</section -->

				<section>
					<h3>Wojciech Barczyński</h3>
					<div class="container">
						<div class="row">
							<div class='col-md-8'>
								<ul>
									<li>Lead Software Developer<br />&amp; System Engineer</li>
									<li>Organizer Golang Warsaw Meetup</li>
									<li>Visiting Lecturer at WSB and ALK</li>
									<li>Trainings &amp; Consultancy</li>
								</ul>
							</div>
							<div class='col-md-3'>
								<!-- img style="padding:12px" src="img/logo_smacc_hypatos.png" / -->
							</div>
						</div>
						<div class="row d-flex flex-row justify-content-center align-items-center">
							<br />
							<br />
							<br />
							<p><small>G<span style="text-transform: lowercase;">ithub: </span><a href="https://github.com/wojciech12" style="color:#fe702f"><span style="text-transform: lowercase;">wojciech12</span></a>
								| Linked: <a href="https://www.linkedin.com/in/wojciechbarczynski/" style="color:#fe702f">IN</a>
								| HP<span style="text-transform: lowercase;">: </span><a href="http://wbarczynski.pl" style="color:#fe702f"><span style="text-transform: lowercase;">wbarczynski.pl</span></a>
								| T: <a href="https://twitter.com/wbarczynski" style="color:#fe702f"><span style="text-transform: lowercase;">@wbarczynski</span></a></small></p>
						</div>
					</div>
				</section>

				<!--
					Tell me a story
				-->
				<section>
					<h3>Story</h3><!-- Dude, why should I listen to you? -->
					<p>Kubernetes + Go + ...</p>
						<ul>
							<li><b>Codility</b></li>
							<li><b>SMACC/Hypatos</b> - Fintech / ML - since 2017</li>
							<li><b>Lyke</b> - Mobile Fashion app - since 2016</li>
						</ul>
						<br />
					<p>I do not like Infra</p>

				</section>

				<section data-background="img/intro/company_welcome.png" data-background-repeat="" data-background-size="100%">
				</section>

				<section data-background="img/intro/my_experience.png" data-background-repeat="" data-background-size="100%">
				</section>


				<section data-background="img/intro/black_box.png" data-background-repeat="" data-background-size="100%">
				</section>

				<section data-background="img/intro/lingua_franca.png" data-background-repeat="" data-background-size="100%">
				</section>

				<section data-background="img/intro/learn_as_you_go.png" data-background-repeat="" data-background-size="100%">
				</section>

				<section data-background="img/intro/app_way_smarter.png" data-background-repeat="" data-background-size="100%">
				</section>


				<section>
					<h4>Kubernetes</h4>

					<ul>
						<li>Container management</li>
						<li>Battery for 12factor apps</li>
						<li>...heading to integration platform</li>
						<li>...becoming a framework for your Xubernetes</li><!-- se Tim Hockin: "Kubernetes as an Extensible Platform" -->
					</ul>
				</section>

				<section>
					<h3>Kubernetes</h3>
					<img src="img/k8s_intro.svg" style="width:90%"/>
					<small><code>make docker_push; kubectl create -f app-srv-dpl.yaml</code></small>
				</section>

				<section>
					<h3>Scale up! Scale down!</h3>
					<img src="img/k8s_intro_scale_up.svg" style="width:90%"/>
					<small><code>kubectl --replicas=3 -f app-srv-dpl.yaml</code></small>
				</section>

				<section>
					<h3>Deployment and Pods</h3>
					<img src="img/backup_slides/k8s_deployment_and_pods.svg" style="width:80%"/>
				</section>

				<!-- section>
					<h3>Deployment.yml</h3>

					<pre><code class="yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: demo-api
  labels:
    app: demo-api
spec:
  replicas: 3
  strategy:
    type: Recreate
  selector:
    matchLabels:
      app: demo-api
  template:
    metadata:
      labels:
        app: demo-api
    spec:
      containers:
      - name: app
        image: wojciech11/api-status:1.0.0
        ports:
        - containerPort: 80</code></pre>
				</section -->

				<section>
					<h3>Service and pods</h3>
					<img src="img/backup_slides/k8s_service_and_pods.svg" style="width:80%" />
					<p><small>Service matches pods based on labels</small></p>
				</section>

				<section data-markdown>
					<script type="text/template">
### Ingress

<table>
	<thread>
		<tr>
			<th>Pattern</th><th>Target App Service</th>
		</tr>
	</thread>
	<tbody>
		<tr>
			<td>api.smacc.io/v1/users</td><td>users-v1</td>
		</tr>
		<tr>
			<td>api.smacc.io/v2/users</td><td>users-v2</td>
		</tr>
		<tr>
			<td>smacc.io</td><td>web</td>
		</tr>
	</tbody>
</table>
					</script>
				</section>

				<section>
					<h5>Ingress Controller</h5>
					<img src="img/traefik_architecture.svg" />
				</section>


				<!-- section>
					<h3>Service.yml</h3>

					<pre><code class="yaml">apiVersion: v1
kind: Service
metadata:
  name: demo-api
spec:
  ports:
  - port: 80
    protocol: TCP
  selector:
    app: demo-api
  type: LoadBalancer</code></pre>
				</section -->

				<section>
					<h4>Basic Concepts</h4>
					<p><table>
						<thread>
							<tr>
								<th>Name</th><th>Purpose</th><th></th>
							</tr>
						</thread>
						<tbody>
							<tr>
								<td>Service</td><td>Interface</td><td>Entry point (Service Name)</td>
							</tr>
							<tr>
								<td>Deployment</td><td>Factory</td><td>How many pods, which pods</td>
							</tr>
							<tr>
								<td>Pod</td><td>Implementation</td><td>1+ docker running</td>
							</tr>
						</tbody>
					</table></p>
				</section>

				<section>
					<h3>Load-balancing</h3>
					<img src="img/k8s_loadbalancing.svg" style="width:90%" />
				</section>

				<section>
				<h3>Pods</h3>
				<div class="container">
					<div class="row">
						<div class='col-md-6'>
							<ul>
								<li>See each other on localhost</li>
								<li>Live and die together</li>
								<li>Can expose multiple ports</li>
							</ul>
						</div>
						<div class='col-md-5'>
							<img src="img/backup_slides/k8s_pod.svg" style="width:90%" />
						</div>
					</div>
				</div>
				</section>

				<section>
					<h3>Side-cars</h3>
					<img src="img/backup_slides/k8s_pod_2.svg" style="width:90%" />
				</section>

				<!-- section>
					<h3>How get user requests?</h3>
						<img src="img/traefik_architecture.svg" width="90%"/>

				</section -->

				<section data-markdown>
					<script type="text/template">
### Service Discovery<br />and Labeling

- names in DNS: <br /><code>curl http://users/list</code>
- labels:<br /><code>name=value</code>
- annotations: <br /><code>prometheus.io/scrape: "true"</code>
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### Service Discovery

- loosely couple components
- auto-wiring with logging and monitoring
- drop-in installation (traefik, prometheus, ...)
					</script>
				</section>


				<section>
					<h4>Example: rolling updates</h4>
					<img src="img/k8s_updates_rolling_1.svg" />
				</section>

				<section>
					<h4>Example: rolling updates</h4>
					<img src="img/k8s_updates_rolling_2.svg" /> 
				</section>

				<section>
					<h4>Example: rolling updates</h3>
					<img src="img/k8s_updates_rolling_3.svg" />
				</section>

				<section>
					<h4>Resilient infra</h4>
					<img src="img/k8s_ha_resistance_1.svg" widht="80%"/>
				</section>

				<section>
					<h4>Resilient infra</h4>
					<img src="img/k8s_ha_resistance_2.svg" widht="80%"/>
				</section>

				<section>
					<h4>Resilient infra</h4>
					<img src="img/k8s_ha_resistance_3.svg" widht="80%"/>
				</section>

				<section data-markdown>
					<script type="text/template">
### All hail the git!

- Yaml
- integration:<br />monitoring, alarming, ingress-controller
- ...
- Devs can forget about infra... almost
- DevOps Culture Dream!

<p><small>+ all tools -&gt; CRD </small></p>
					</script>
				</section>



<section>
<h3>E<span style="text-transform: lowercase;">ffective</span> K<span style="text-transform: lowercase;">ubernetes</span></h3>
<ul>
	<li>Start with small iterations</li>
	<li>Learn as-you-go</li>
	<li>Keep Kubernetes Understable</li>
</ul>
<p><b>Hope the k8s community keep it this way</b></p>
</section>

<section>
<h3>E<span style="text-transform: lowercase;">ffective</span> K<span style="text-transform: lowercase;">ubernetes</span></h3>
<ul>
	<li>Move configuration to runtime</li>
	<li>Do not terrorize your devs with K8S</li>
	<li>No free lunch... app must be smarter</li>
</ul>
</section>

<section data-background="img/smacc_header_IT_source.jpg" data-background-repeat="" data-background-size="100%" data-background-position="bottom"
			style="position: relative; top:0">
				<h4>Thank you. Questions?</h4>
			</section>

			<section data-background="img/smacc_header_IT_source.jpg" data-background-repeat="" data-background-size="100%" data-background-position="bottom"
						style="position: relative; top:0">
							<h4><span style="text-transform: lowercase;">https://github.com/wojciech12/workshop_kubernetes_and_cloudnative</span></h4>
						</section>

					<!--
						BACKUP SLIDES
					-->
				<section data-background="img/smacc_header_IT_source.jpg" data-background-repeat="" data-background-size="100%" data-background-position="bottom" style="position: relative; top:0">
					<h2>Backup Slides</h2>
				</section>

				<section data-markdown>
					<script type="text/template">
### Infra tools

- Prometheus + AlertMnager + Grafana
- Traefik
- Kafka - Yolean/kubernetes-kafka
- Vault on Etcd - banzaicloud/bank-vaults
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### Data stores

- Kafka - Yolean/kubernetes-kafka
- Etcd - coreos/etcd-operator
- DB: PSQL and Mongo
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### Backups:

- old-school backups  with ARK and Restic
- replications across clouds
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 1. Clean up

- Single script for repo - Makefile [1]
- Resurrect the README

<small>[1] With zsh or bash auto-completion plug-in in your terminal.</small>
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 2. Get back all the knowledge

Extract from:

- Puppet, ... ➡ Dockerfile
- Running Instances ➡ Dockerfile, README.rst
- Nagios, ... ➡ README.rst + <code>checks/</code>
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 3. Introduce run_local

- <code>make run_local</code>
- A nice section on how to run in README.rst
- with <code>docker-compose</code>

<p>The most crucial point.</p>
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 4. Get to kubernetes

- <code>make kube_create_config</code>
- <code>make kube_apply</code>
- Generate the yaml files if your envs differ

<p><small>secrets from gopass (password manager)</small></p>
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 5. Continuous Deployment

Travis:

- the same Makefile as dev use
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 6. Keep it running

Bridge the new with old:

- Use External Services in Kubernetes
- Expose k8s in the Legacy [1]

<p><small>[1] hard coded IP:PORT, considered: K8S events to Consul</small></p>
					</script>
				</section>

				<section>
					<h8>Bridge the new with old</h8>
					<img src="img/lyke/lyke_new_with_old.svg" width="80%">
					<p><small>Monitor legacy with new stack</small></p>
				</section>

				<section>
					<h8>Architecture During Migration</h8>
					<img src="img/lyke/lyke_immediately_architecture.svg" width="80%"><!-- br /-->
					<!-- small>No dev?</small -->
				</section>

				<section data-markdown>
					<script type="text/template">
### 7. Introduce smoke-test

<pre><code class="bash">TARGET_URL=127.0.0 make smoke_test
TARGET_URL=api.example.com/users make smoke_test</code></pre>
</script>
<!-- small>Cut pinging tester or ... to check whether component really is running</small-->
				</section>

				<section data-markdown>
					<script type="text/template">
### 8. Service self-aware

Add to old services:

1. <i>metrics/</i>
2. <i>health/</i>
3. <i>info/</li>
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 9. Move to micro-services

Offload Legacy:

- Keep the lights on
- New functionality to micro-services
					</script>
				</section>

				<section data-markdown>
					<script type="text/template">
### 10. Get performance testing

- <i>wrk</i> for evaluating performance
- load test the real system
					</script>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>

		<!-- script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
				]
			});
		</script -->
	</body>
</html>
